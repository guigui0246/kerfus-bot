;(function() {
    "use strict";

	// http://javascript.ru/ajax/intro
	f.getXHR = function() {
		var xmlhttp;
		try {
			xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
		} catch (e) {
			try {
				xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
			} catch (E) {
				xmlhttp = false;
			}
		}
		if (!xmlhttp && typeof XMLHttpRequest!='undefined') {
			xmlhttp = new XMLHttpRequest();
		}
		return xmlhttp;
	};
    
    f.ajax = function() {
        return new Promise(function(resolve, reject) { // jshint ignore: line
            $.ajax(
                f.deepMixin(params, {
                    success: function(response) {
                        try {
                            response = JSON.parse(response);
                            resolve(response);
                        } catch(err) {
                            reject(err);
                        }
                    },
                    error: function(err) {
                        reject(err);
                    }
                })
            );
        });
    };
    
})();
