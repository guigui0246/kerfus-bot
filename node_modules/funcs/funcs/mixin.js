;(function() {
    "use strict";

    // "глубокое" смешивание
    f.deepMixin = function() {
        var obj = {},
            objs = [];

        [].forEach.call(arguments, function(obj) {
            if ( f.isObject(obj) ) {
                objs.push(obj);
            }
        });

        function mixin(a, b) {
            var value;

            for (var key in b) {
                value = b[key];

                if ( f.isEasyObject(value) ) {
                    if ( !f.isObject(a[key]) ) {
                        a[key] = {};
                    }
                    mixin(a[key], value);
                } else
                if ( f.isArray(value) ) {
                    a[key] = [];
                    value.forEach(function(elem) {
                        a[key].push( f.deepClone({x:elem}).x );
                    });
                } else {
                    a[key] = value;
                }
            }

            return a;
        }

        objs.forEach(function(copyObj) {
            mixin(obj, copyObj);
        });

        return obj;
    };

    // замиксовать только уникальные значения из объектов
    f.mixinUnique = function(source) {
		var objs = [].slice.call(arguments, 1);
		var allObjs = objs.concat([source]);
		if ( objs.length < 2 ) {
			return source;
		}

		var obj, others;
		for (var i=0, n=objs.length; i<n; i++) {
			obj = objs[i];
			others = allObjs.slice();
			others.splice(i, 1);

			for (var key in obj) {
				if ( f.objIndexOfByKey(others, key) == -1 ) {
					source[key] = obj[key];
				}
			}
		}

		return source;
	};
    
    f.toUpperFields = function(row) {
        var value;

        for (var key in row) {
            value = row[key];
            delete row[key];
            key = key.toUpperCase();
            row[key] = value;
        }
        
        return row;
    };
})();
