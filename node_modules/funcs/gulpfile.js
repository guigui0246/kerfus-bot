var gulp = require('gulp'),
	uglify = require('gulp-uglify'), // Минификация JS
	concat = require('gulp-concat'), // склейка
	fs = require('fs')
;

gulp.task('default', function() {

	var preStr = fs.readFileSync('./pre-funcs.js').toString();
	var postStr = fs.readFileSync('./post-funcs.js').toString();

	gulp.src(['./funcs/*.js'])
			.pipe(concat('funcs.min.js'))
			.pipe(uglify())
			.pipe(gulp.dest('./'))
			.on("end", function() {
				var bodyMin = fs.readFileSync('./funcs.min.js').toString();
				fs.writeFileSync('./funcs.min.js', preStr + bodyMin + postStr);
			});

	gulp.src(['./funcs/*.js'])
			.pipe(concat('funcs.js'))
			.pipe(gulp.dest('./'))
			.on("end", function() {
				var body = fs.readFileSync('./funcs.js').toString();
				fs.writeFileSync('./funcs.js', preStr + body + postStr);
			});

})
